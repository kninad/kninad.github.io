<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="dcterms.date" content="2018-05-19">
  <title>Building this website</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../static/css/pandoc.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="topnav">
  <!-- <hr /> -->
    <div href="index.html" class="nav_item ${if(navbar_home)}nav_item_active${endif}">
      <a href="../index.html"> Home |</a>
    </div>
    <div href="research.html" class="nav_item ${if(navbar_research)}nav_item_active${endif}">
      <a href="../research.html">Research |</a>
    </div>
    <div href="teaching.html" class="nav_item ${if(navbar_teaching)}nav_item_active${endif}">
      <a href="../teaching.html">Teaching |</a>
    </div>
    <div href="notes.html" class="nav_item ${if(navbar_notes)}nav_item_active${endif}">
      <a href="../notes.html">Notes |</a>
    </div>
    <div href="misc.html" class="nav_item ${if(navbar_misc)}nav_item_active${endif}">
      <a href="../misc.html">Misc </a>
    </div>

  </div>
  <hr />
<nav id="TOC">
<ul class="incremental">
<li><a href="#building-this-website">Building this website</a><ul class="incremental">
<li><a href="#update-makefiles">2023 Update (Makefiles!)</a></li>
</ul></li>
</ul>
</nav>
<p><a href="../notes.html">&lt;&lt; back to notes/blog</a></p>
<h1 id="building-this-website">Building this website</h1>
<p>Date: 2018-05-10</p>
<p>I wrote this page to document the process of creating this website. I took the help of <a href="https://pandoc.org/">pandoc</a> to simplify the entire process. Pandoc is a very useful document converter and a handy tool for creating the html syntax of the website from a markdown file. After creating the necessary files (locally), I used <a href="https://pages.github.com/">Github pages</a> for hosting the website. Primary references for design: <a href="http://bettermotherfuckingwebsite.com/">this</a>, <a href="https://bestmotherfucking.website/">this</a> and <a href="https://thebestmotherfucking.website/">this</a> (although I take some liberty to break some of the commandments described in them).</p>
<p>Each page of this website was written in <a href="http://pandoc.org/MANUAL.html#pandocs-markdown">markdown</a> and hence it was very easy to write or modify the content and track the changes using git. The basic pandoc command for converting the markdown file to html will only output a plain html file. Although pandoc supports writing html syntax in the markdown file, its usually not recommended as its better to keep the markdown file clean.</p>
<p>For further modifications, pandoc supports passing custom html files which can be added to three positions (header, before-body and after-body) in the final html code for the page. Additionally, one can play around with the pandoc’s default html template for gaining control over the placement of certain elements (like div) in the overall code. Finally a slightly modified version of <a href="https://gist.github.com/killercup/5917178">this css file</a> was used for styling the website. It took care of making the website look a bit nice and tidy.</p>
<p>To avoid writing the long pandoc command for each file, I wrote a simple bash script to run the command on all the markdown files which made modifying the website content very convinient.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="va">Rootdir=</span><span class="st">&quot;.&quot;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="va">AUTHOR=</span><span class="st">&quot;Ninad&quot;</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="va">CSS=</span><span class="st">&quot;</span><span class="va">${Rootdir}</span><span class="st">/css/pandoc.css&quot;</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">for</span> <span class="ex">mf</span> in <span class="va">$Rootdir</span>/*.md</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">do</span></a>
<a class="sourceLine" id="cb1-9" title="9">    <span class="va">filename=</span><span class="st">&quot;</span><span class="va">${mf%</span>.*<span class="va">}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="bu">echo</span> <span class="st">&quot;Converting </span><span class="va">$mf</span><span class="st"> to </span><span class="va">$filename</span><span class="st">.html&quot;</span> <span class="co">#Pandoc command for conversion to html:     </span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="ex">pandoc</span> \</a>
<a class="sourceLine" id="cb1-12" title="12">        --css <span class="st">&quot;</span><span class="va">$CSS</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb1-13" title="13">        <span class="ex">-V</span> author-meta=<span class="st">&quot;</span><span class="va">$AUTHOR</span><span class="st">&quot;</span> \</a>
<a class="sourceLine" id="cb1-14" title="14">        -f markdown -t html5 <span class="va">$mf</span> -o <span class="va">$filename</span>.html      </a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">done</span>    </a></code></pre></div>
<h2 id="update-makefiles">2023 Update (Makefiles!)</h2>
<p>The above process kind of works but it makes a strong assumption that all the files are in a single directory without any nesting. However this is not an ideal layout if we want to separate content like blog, projects etc. Additionally, it re-generates <em>all</em> the files without a check whether something has changed or not! To counter the above two points we can setup a simple <code>Makefile</code> based approach to build the website.</p>
<p>This Makefile still only process documents in the current directory but if we have such a makefile in every sub-directory taking care that each of the nested makefiles have <code>all, clean</code> targets, then this kind of workflow will work.</p>
<ul class="incremental">
<li>Collect current dir markdown files <code>SOURCES = $(wildcard *.md)</code></li>
<li>Create html targets using pattern substitution: <code>$(patsubst %.md,%.html,$(SOURCES))</code></li>
<li>Have a <code>all</code> target where we also go into the sub-dirs (here we only have <code>blog</code>) and run <code>make</code> on their respective <code>all</code> targets</li>
<li>The actual <code>pandoc</code> command is quite straightforward:
<ul class="incremental">
<li>I have a lua filter to convert all internal markdown links to html</li>
<li>Using a specific css file (note, path to it will change in the Makefile in sub-dirs)</li>
<li>Add a navbar and footer</li>
</ul></li>
<li>The <code>clean</code> target also has a <code>cd subdir &amp;&amp; make $@</code> to automate the cleaning using the sub-dir’s Makefile (remember we need to add <code>clean</code> in it as well).</li>
</ul>
<p>Thus we need a single command to build out the entire website: <code>make all</code> and a single command to clean all generated files: <code>make clean</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode makefile"><code class="sourceCode makefile"><a class="sourceLine" id="cb2-1" title="1"><span class="dt">STRING1 </span><span class="ch">=</span><span class="st"> &quot;Last updated on &quot;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="dt">STRING2 </span><span class="ch">=</span><span class="st"> &quot;Created using [pandoc]\(http://pandoc.org/\).&quot;</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="dt">SOURCES </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">wildcard</span><span class="st"> *.md</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dt">HTMLs </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> %.md</span><span class="kw">,</span><span class="st">%.html</span><span class="kw">,</span><span class="ch">$(</span><span class="dt">SOURCES</span><span class="ch">))</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># See the A B website (youtube video) for sep shell scripts for blog portion</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dt">TEMPFILE </span><span class="ch">=</span><span class="st"> sdfgsdfs7fs8d7tfgsduifgsdi5234j</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="ot">.PHONY</span> <span class="ot">:</span><span class="dt"> all</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="dv">all:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">HTMLs</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-11" title="11">    echo <span class="st">&quot;Building the blog using its Makefile&quot;</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="ch">@</span><span class="fu">cd blog &amp;&amp; make </span><span class="ch">$@</span></a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="dv">%.html:</span><span class="dt"> %.md</span></a>
<a class="sourceLine" id="cb2-15" title="15">    <span class="ch">@</span><span class="fu">cat </span><span class="ch">$&lt;</span><span class="fu"> &gt; </span><span class="ch">$(</span><span class="dt">TEMPFILE</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="ch">@</span><span class="fu">echo </span><span class="st">&quot;\n &lt;hr / id=&quot;</span><span class="fu">hr_footer</span><span class="st">&quot;&gt;*&lt;span class=&quot;</span><span class="fu">footer</span><span class="st">&quot;&gt;</span><span class="ch">$(</span><span class="dt">STRING1</span><span class="ch">)</span><span class="st"> `stat -c %Y Makefile | date +&#39;%b %d, %Y&#39;`. </span><span class="ch">$(</span><span class="dt">STRING2</span><span class="ch">)</span><span class="st">*&lt;/span&gt;&quot;</span><span class="fu"> &gt;&gt; </span><span class="ch">$(</span><span class="dt">TEMPFILE</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="ch">@</span><span class="fu">pandoc --lua-filter=./static/links-to-html.lua -c ./static/css/pandoc.css -B navbar.html --mathjax -t html5 --standalone -i </span><span class="ch">$(</span><span class="dt">TEMPFILE</span><span class="ch">)</span><span class="fu"> -o </span><span class="ch">$@</span></a>
<a class="sourceLine" id="cb2-18" title="18">    <span class="ch">@</span><span class="fu">rm -f </span><span class="ch">$(</span><span class="dt">TEMPFILE</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="ot">.PHONY</span> <span class="ot">:</span><span class="dt"> clean</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="dv">clean:</span></a>
<a class="sourceLine" id="cb2-22" title="22">    rm -f <span class="ch">$(</span><span class="dt">HTMLs</span><span class="ch">)</span></a>
<a class="sourceLine" id="cb2-23" title="23">    cd blog &amp;&amp; make <span class="ch">$@</span></a></code></pre></div>
<hr />
<p><span class="footer"><em>Last updated on Aug 02, 2023. Created using <a href="http://pandoc.org/">pandoc</a>.</em></span></p>
</body>
</html>
